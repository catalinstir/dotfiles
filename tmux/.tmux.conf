# --- PREFIX ---
unbind C-b
set-option -g prefix C-a
bind C-a send-prefix
bind C-a last-window

# --- GENERAL SETTINGS ---
set -sg escape-time 0
set -g history-limit 10000
set -g mouse on
set -g mode-keys vi
set -g base-index 1
setw -g pane-base-index 1
set -g renumber-windows on

# --- SPLITS ---
unbind %
unbind '"'
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"

# --- NAVIGATION ---
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Resize panes
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# --- COPY MODE ---
bind -T copy-mode-vi v send-keys -X begin-selection
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "xclip -sel clip -i"

# --- STATUS BAR (TOP, CENTERED, GRAYSCALE) ---
set -g status-position top
set -g status-justify centre
set -g status-style bg=colour233,fg=colour255

# Left: session name + prefix indicator + cpu + battery
set -g status-left "#[fg=colour255,bg=colour233]  #S #{prefix_highlight} "
set -g status-left-length 40

# Right: cpu/battery + time
set -g status-right "#{cpu_fg_color} #{cpu_percentage} #{battery_icon} #{battery_percentage} #[fg=colour255,bg=colour233]  %H:%M "
set -g status-right-length 60

# Window list format (unfocused tabs dimmed)
set -g window-status-format "#[fg=colour240] #I:#W "
set -g window-status-current-format "#[fg=colour255,bg=colour233] #I:#W "

# --- PANE BORDERS ---
set -g pane-border-style fg=colour238
set -g pane-active-border-style fg=colour245

# --- PLUGIN SETTINGS ---

# tmux-prefix-highlight (minimal style with icons)
set -g @prefix_highlight_fg 'colour234'
set -g @prefix_highlight_bg 'colour250'
set -g @prefix_highlight_show_copy_mode 'on'
set -g @prefix_highlight_copy_mode_attr 'fg=colour234,bg=colour250'
set -g @prefix_highlight_prefix_prompt '󰌌'
set -g @prefix_highlight_copy_prompt ''

# tmux-cpu (grayscale colors)
set -g @cpu_low_fg_color "#[fg=colour250]"
set -g @cpu_medium_fg_color "#[fg=colour246]"
set -g @cpu_high_fg_color "#[fg=colour255]"
set -g @cpu_percentage_format "%3.0f%%"

# tmux-battery (nerd font icons)
set -g @batt_icon_charge_tier8 '󰁻'
set -g @batt_icon_charge_tier7 '󰁼'
set -g @batt_icon_charge_tier6 '󰁽'
set -g @batt_icon_charge_tier5 '󰁾'
set -g @batt_icon_charge_tier4 '󰁿'
set -g @batt_icon_charge_tier3 '󰂀'
set -g @batt_icon_charge_tier2 '󰂁'
set -g @batt_icon_charge_tier1 '󰂂'
set -g @batt_icon_status_charged '󰁹'
set -g @batt_icon_status_charging '󰂄'
set -g @batt_icon_status_discharging '󰂃'

# tmux-fzf (trigger with prefix + F)
TMUX_FZF_LAUNCH_KEY="F"

# tmux-yank (works automatically, no config needed)

# tmux-open (works automatically in copy mode)
# Press 'o' in copy mode to open selection
# Press 'Ctrl-o' to open in $EDITOR

# --- PLUGINS ---
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'tmux-plugins/tmux-open'
set -g @plugin 'sainnhe/tmux-fzf'
set -g @plugin 'tmux-plugins/tmux-cpu'
set -g @plugin 'tmux-plugins/tmux-battery'
set -g @plugin 'tmux-plugins/tmux-prefix-highlight'

# --- RELOAD CONFIG ---
bind r source-file ~/.tmux.conf \; display "Config reloaded!"

# --- MISC ---
set -g set-titles on
set -g set-titles-string "#T"

# Initialize TPM (keep this at the very bottom)
run '~/.tmux/plugins/tpm/tpm'
